var U=function(_){throw Error(_)},d=function(_){return v.href=chrome.runtime.getURL("/_favicon/"),v.searchParams.set("pageUrl",_),v.searchParams.set("size","16"),v.toString()},F=function(_,j){if(Z.url=_,Z.active=X.focusTabs,X.open==="0"===!j)chrome.tabs.update(k.id,Z,void 0);else chrome.tabs.create(Z,void 0)},I=function(_){const z=P.templateRange.content.cloneNode(!0).firstElementChild,q=z.firstElementChild,J=q.firstElementChild,N=E.format(_);J.textContent=N;const Y=q.lastElementChild;if(Q.mode==="d")Y.title=`Remove all browsing history form ${N}`,Y.setAttribute("data-range",String(_)),Y.appendChild(P.templateIconDelete.content.cloneNode(!0));else Y.setAttribute("data-display","0");return z},x=function(_,j){var z=P.templateItem.content.cloneNode(!0),q=z.firstElementChild;q.href=_.url,q.title=_.title+"\n"+_.url;var J=q.children,N=J[0];if(_.url===void 0)U("hitem.url is undefined");N.src=d(_.url);var Y=J[1];if(_.title==="")Y.textContent=_.url;else Y.textContent=_.title;var B=J[2],H=B.firstElementChild;H.setAttribute("data-url",_.url),H.setAttribute("data-range",String(j)),H.appendChild(P.templateIconDelete.content.cloneNode(!0));var C=B.lastElementChild;return C.textContent=b.format(_.lastVisitTime),q},y=function(_){if(_.length<1||_.length===1&&_[0].id===Q.lastItemId){console.info("No more History"),Q.historyFinished=!0,P.loading.setAttribute("data-display","0");return}var j,z;if(G.length>0)j=P.container.lastElementChild,P.fragment.appendChild(j),z=G.getIndex(W.start);var q,J=0;if(_[0].id===Q.lastItemId)J=1;while(J<_.length){var N=_[J];if(q=N.lastVisitTime,q===void 0)U("hitem.lastVisitTime is undefined");if(W.start>q)W.update(q),z=G.set(W.end,W.start),j=I(W.start),P.fragment.appendChild(j);if(z===void 0)U("rangeIndex is undefind");Q.lastItemId=N.id,Q.totalItems+=1,G.addCount(z);const Y=x(N,W.start);j.appendChild(Y),J+=1}if(q!==void 0)$.endTime=q,P.container.appendChild(P.fragment);P.loading.setAttribute("data-display","0")},K=function(_){if(y(_),Q.historyFinished){P.noHistory.setAttribute("data-display","1");return}else P.noHistory.setAttribute("data-display","0")},f=function(){if(Q.historyFinished){P.noHistory.setAttribute("data-display","1");return}else if(P.container.clientHeight===P.container.scrollHeight)P.loading.setAttribute("data-display","1"),chrome.history.search($,K)},u=function(_){var{open:j,focusTabs:z,theme:q}=_,J=!1;if(j===void 0)J=!0;else X.open=j,P.modalConfigOpen.value=j;if(z===void 0)J=!0;else X.focusTabs=z,P.modalConfigFocus.checked=z;if(q===void 0)J=!0;else X.theme=q,document.firstElementChild?.setAttribute("class",q);if(J)chrome.storage.local.set(X,void 0)},p=function(_,j){if(_==="0"){const z=j.getAttribute("data-url"),q=j.getAttribute("data-range");if(z===null||q===null)return;const J=j.parentElement.parentElement;V.url=z,chrome.history.deleteUrl(V,void 0);const N=G.getIndex(Number(q));if(N<0)return;if(G.subtractCount(N),G.count[N]<1)J.parentElement.remove(),G.remove(N);else J.remove();Q.totalItems-=1,f()}else if(_==="1"){const z=j.getAttribute("data-range");if(z===null)return;const q=G.getIndex(Number(z));if(q<0)return;let J=G.end[q],N=G.start[q],Y=G.count[q];Q.totalItems-=Y,L.endTime=J,L.startTime=N,chrome.history.deleteRange(L),j.parentElement.parentElement.remove(),G.remove(q),f()}},T=function(_){if(Q.historyFinished)return;const j=_.currentTarget;if(j.scrollTop>=j.scrollHeight-j.clientHeight-50)P.loading.setAttribute("data-display","1"),chrome.history.search($,y)},c=function(_){$.text=_.value,$.endTime=Date.now(),P.loading.setAttribute("data-display","1"),Q.reset(),G.reset(),W.reset(),P.container.replaceChildren(),chrome.history.search($,K),w=void 0},A=function(){if(P.inputSearch.value.length===0)P.buttonSearch.setAttribute("data-display","0"),Q.mode="d";else P.buttonSearch.setAttribute("data-display","1"),Q.mode="s";if(w!==void 0)clearTimeout(w);w=setTimeout(c,500,P.inputSearch),P.loading.setAttribute("data-display","1")},R=function(_){var j=_.target,z=j.getAttribute("data-button");if(z==="0")F("chrome://history",!1);else if(z==="1")Z.url="chrome://settings/clearBrowserData",Z.active=!0,chrome.tabs.create(Z,void 0);else if(z==="2")P.modalConfig?.setAttribute("data-display","1");else if(z==="3")window.close()},l=function(){P.inputSearch.value="",A()},h=function(_){var j=_.target,z=j.getAttribute("data-type");if(z==="0"){_.preventDefault();var q=j.getAttribute("href");Z.url=q,Z.active=X.focusTabs,chrome.tabs.create(Z,void 0)}},o=function(_){var j=_.target,z=j.getAttribute("data-type");if(z==="2"){const q=j.getAttribute("data-parent");p(q,j),_.preventDefault();return}if(z==="0"){if(!_.shiftKey){const q=j.href;F(q,_.ctrlKey),_.preventDefault()}}},g=function(_){var j=_.target,z=j.getAttribute("data-type");if(z=="3"||z==="2")P.modalConfig?.setAttribute("data-display","0")},s=function(_){var j=_.currentTarget;X.theme=j.value,document.firstElementChild?.setAttribute("class",j.value),chrome.storage.local.set(X,void 0)},S=function(_){var j=_.currentTarget;X.open=j.value,chrome.storage.local.set(X,void 0)},m=function(_){var j=_.currentTarget;X.focusTabs=j.checked,chrome.storage.local.set(X,void 0)},r=function(_){k=_[0],chrome.history.search($,K)},M=function(){if(P.loading=document.getElementById("loading"),P.loading===null)throw Error("DOM.loading is null");if(P.headerButtons=document.getElementById("header_buttons"),P.headerButtons===null)throw Error("DOM.headerButtons is null");if(P.inputSearch=document.getElementById("input_search"),P.inputSearch===null)throw Error("DOM.inputSearch is null");if(P.buttonSearch=document.getElementById("button_search"),P.buttonSearch===null)throw Error("DOM.buttonSearch is null");if(P.noHistory=document.getElementById("no-history"),P.noHistory===null)throw Error("DOM.noHistory is null");if(P.container=document.getElementById("container"),P.container===null)throw Error("DOM.container is null");if(P.modalConfig=document.getElementById("modal_config"),P.modalConfig===null)throw Error("DOM.modalConfig is null");if(P.modalConfigTheme=document.getElementById("modal_config-theme"),P.modalConfigTheme===null)throw Error("DOM.modalConfigTheme is null");if(P.modalConfigOpen=document.getElementById("modal_config-open"),P.modalConfigOpen===null)throw Error("DOM.modalConfigOpen is null");if(P.modalConfigFocus=document.getElementById("modal_config-focus"),P.modalConfigFocus===null)throw Error("DOM.modalConfigFocus is null");if(P.templateRange=document.getElementById("template_range"),P.templateRange===null)throw Error("DOM.templateRange is null");if(P.templateItem=document.getElementById("template_item"),P.templateItem===null)throw Error("DOM.templateItem is null");if(P.templateIconDelete=document.getElementById("template_icon-delete"),P.templateIconDelete===null)throw Error("DOM.templateIconDelete is null");P.headerButtons.onclick=R,P.inputSearch.oninput=A,P.buttonSearch.onclick=l,P.container.onscroll=T,P.container.onclick=o,P.container.onauxclick=h,P.modalConfig.onclick=g,P.modalConfigTheme.onchange=s,P.modalConfigOpen.onchange=S,P.modalConfigFocus.onchange=m,chrome.storage.local.get(void 0,u),chrome.tabs.query({active:!0,currentWindow:!0},r)};var b=Intl.DateTimeFormat(void 0,{timeStyle:"short"}),E=Intl.DateTimeFormat(void 0,{dateStyle:"full"}),P={container:null,inputSearch:null,headerButtons:null,buttonSearch:null,noHistory:null,loading:null,modalConfig:null,modalConfigTheme:null,modalConfigOpen:null,modalConfigFocus:null,templateItem:null,templateRange:null,templateIconDelete:null,fragment:document.createDocumentFragment()},X={focusTabs:!1,open:"0",theme:"dark"},Q={MIN_SEARCDOM_RESULTS:30,lastItemId:"",totalItems:0,historyFinished:!1,mode:"d",reset(){Q.lastItemId="",Q.totalItems=0,Q.historyFinished=!1}},k=void 0,$={text:"",maxResults:Q.MIN_SEARCDOM_RESULTS,startTime:0,endTime:Date.now()},W={OFFSET:60000*(new Date()).getTimezoneOffset(),start:$.endTime,end:$.endTime,update(_){W.end=W.start,W.start=_-(_-W.OFFSET)%86400000},reset(){var _=Date.now();W.end=_,W.start=_}},G={end:[],start:[],count:[],length:0,addCount(_){const j=G.count;if(_<0||j.length<=_)return!1;return j[_]+=1,!0},getIndex(_){var j=G.start,z=j.length;if(z<11)return j.indexOf(_);var q=0,J=0,N=0;while(q<z)if(J=q+Math.floor((z-q)/2),N=j[J],_===N)return J;else if(N<_)z=J;else q=J+1;return-1},remove(_){var j=G.length;if(_<0||j<=_)return!1;return G.end.copyWithin(_,_+1,j),G.end.pop(),G.start.copyWithin(_,_+1,j),G.start.pop(),G.count.copyWithin(_,_+1,j),G.count.pop(),G.length-=1,!0},reset(){G.end.length=0,G.start.length=0,G.count.length=0,G.length=0},set(_,j){return G.end.push(_),G.start.push(j),G.count.push(0),G.length+=1,G.length-1},subtractCount(_){const j=G.count;if(_<0||j.length<=_)return!1;if(j[_]>0)j[_]-=1;return!0}},v=new URL("http://t.i"),Z={active:!1,url:""},V={url:""},L={endTime:0,startTime:0},w=void 0;window.addEventListener("DOMContentLoaded",M);
